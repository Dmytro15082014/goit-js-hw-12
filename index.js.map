{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst API_KEY = \"49627345-81d87c81626646e8cd4c1e6ab\";\n\nconst getImagesByQuery = async (query, page = 1) => {\n    const data = await axios(\"https://pixabay.com/api/\",\n        {\n            params: {\n                key: API_KEY,\n                q: query,\n                image_type: \"photo\",\n                orientation: \"horizontal\",\n                safesearch: true,\n                per_page: \"15\",\n                page\n        }});\n    return data\n};\n\nexport default getImagesByQuery;","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst gallery = document.querySelector(\".gallery\");\nconst spinner = document.querySelector(\".loader\");\nconst loadMoreBtn = document.querySelector(\".show-more\");\nconst galleryConstructor = new SimpleLightbox('.gallery-card a', { captionsData: \"alt\", captionDelay: \"250\" });\n\nexport default function createGallery(images){\n    gallery.insertAdjacentHTML(\"beforeend\",\n        images\n            .map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => \n       `<li class=\"image-item\">\n            <div class=\"gallery-card\"><a href=\"${largeImageURL}\"><img src=\"${webformatURL}\" alt=\"${tags}\" class=\"image\"/></a></div>\n            <ul class=\"image-info\">\n                <li>Likes<p>${likes}</p></li>\n                <li>Views<p>${views}</p></li>\n                <li>Comments<p>${comments}</p></li>\n                <li>Downloads<p>${downloads}</p></li>\n            </ul>\n        </li>`).join(\"\")) \n    galleryConstructor.refresh();\n};\n\nexport const clearGallery = () => {\n    gallery.innerHTML = \"\";\n};\n\nexport const showLoader = () => {\n    spinner.classList.remove(\"visually-hidden\");\n};\n\nexport const hideLoader = () => {\n    spinner.classList.add(\"visually-hidden\");\n};\n\nexport const showLoadMoreButton = () => {\n    loadMoreBtn.classList.remove(\"visually-hidden\");\n };\n\nexport const hideLoadMoreButton = () => { \n    loadMoreBtn.classList.add(\"visually-hidden\");\n};\n","import getImagesByQuery from \"./js/pixabay-api\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport createGallery from \"./js/render-functions\";\nimport { clearGallery, showLoader, hideLoader, showLoadMoreButton, hideLoadMoreButton } from \"./js/render-functions\"\n\nconst searchForm = document.querySelector(\".form\");\nconst loadMoreBtn = document.querySelector(\".show-more\");\nconst LC_KEY = \"save-search\";\nlet page = 1;\nlet lastPage;\nloadSaveSettings(page);\n\nsearchForm.addEventListener(\"submit\", searchImage);\nloadMoreBtn.addEventListener(\"click\", handleLoadMore);\n\nasync function searchImage(e) {\n    e.preventDefault();\n    showLoader();\n    hideLoadMoreButton();\n    clearGallery();\n\n    const query = searchForm.elements[0].value.toLowerCase().trim();\n    if (query.length <= 0) {\n        iziToast.show(messageError);\n        hideLoader();\n        searchForm.reset();\n        return\n    };\n    localStorage.setItem(LC_KEY, query)\n\n    try {\n        const { data } = await getImagesByQuery(query);\n        createGallery(data.hits);\n        lastPage = data.totalHits / data.hits.length;\n\n        if (!(data.hits.length)) {\n            iziToast.show(messageError);\n            localStorage.removeItem(LC_KEY);\n            hideLoadMoreButton();            \n            return;\n        }\n        if (page < lastPage) {\n            showLoadMoreButton();\n        }\n        if (page === lastPage) {\n            iziToast.show(lastPageMessage);\n        };\n    } catch (error) {\n        messageError.message = error.message;\n        iziToast.show(messageError);       \n    } finally{\n        hideLoader();\n        searchForm.reset();\n    }; \n};\n\nasync function handleLoadMore(e) {\n    showLoader();\n    page++;\n    loadMoreBtn.disabled = true;\n    let saveSearch = localStorage.getItem(LC_KEY);\n\n    try {\n        const { data } = await getImagesByQuery(saveSearch, page);\n        createGallery(data.hits);\n        if (page >= lastPage) {\n            hideLoadMoreButton();\n            localStorage.removeItem(LC_KEY);\n            page = 1;\n            iziToast.show(lastPageMessage);            \n        };\n        \n        const card = document.querySelector(\".image-item\");\n        const heightScroll = card.getBoundingClientRect().height;\n        window.scrollBy({\n            left: 0,\n            top: heightScroll * 2,\n            behavior: \"smooth\",\n        });\n    } catch (error) {\n        messageError.message = error.message;\n        iziToast.show(messageError);\n    }finally{\n        hideLoader();\n        loadMoreBtn.disabled = false;\n    };\n};\n\nasync function loadSaveSettings(page) {\n    showLoader();\n    if (localStorage.length > 0) {\n        try {\n            const { data } = await getImagesByQuery(localStorage.getItem(LC_KEY), page);\n            createGallery(data.hits);\n            if (page < (data.totalHits / data.hits.length)) {\n                showLoadMoreButton();\n            }\n            if (page === (data.totalHits / data.hits.length)) {\n                iziToast.show(lastPageMessage);\n            }\n        } catch (error) {\n            messageError.message = error.message;\n            iziToast.show(messageError);\n        }\n    };\n    hideLoader();\n}\n\nconst messageError = {\n    title: \"Error\",\n    titleColor: '#fafafb',\n    message: \"Sorry, there are no images matching your search query. Please try again!\",\n    iconColor: \"#fafafb\",\n    color: \"#ef4040\",\n    messageColor: \"#fafafb\",\n    position: \"topRight\",\n    messageSize: \"16px\",\n    messageSize: \"150%\",\n};\n\nconst lastPageMessage = {\n    title: \"\",\n    titleColor: '#fafafb',\n    message: \"We're sorry, but you've reached the end of search results.\",\n    iconColor: \"#fafafb\",\n    color: \"#0A8106\",\n    messageColor: \"#fafafb\",\n    position: \"topRight\",\n    messageSize: \"16px\",\n    messageSize: \"150%\",\n}"],"names":["API_KEY","getImagesByQuery","query","page","axios","gallery","spinner","loadMoreBtn","galleryConstructor","SimpleLightbox","createGallery","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","searchForm","LC_KEY","lastPage","loadSaveSettings","searchImage","handleLoadMore","e","iziToast","messageError","data","lastPageMessage","error","saveSearch","heightScroll"],"mappings":"owBAEA,MAAMA,EAAU,qCAEVC,EAAmB,MAAOC,EAAOC,EAAO,IAC7B,MAAMC,EAAM,2BACrB,CACI,OAAQ,CACJ,IAAKJ,EACL,EAAGE,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,KACV,KAAAC,CACP,CAAA,CAAC,ECZJE,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAU,SAAS,cAAc,SAAS,EAC1CC,EAAc,SAAS,cAAc,YAAY,EACjDC,EAAqB,IAAIC,EAAe,kBAAmB,CAAE,aAAc,MAAO,aAAc,KAAK,CAAE,EAE9F,SAASC,EAAcC,EAAO,CACzCN,EAAQ,mBAAmB,YACvBM,EACK,IAAI,CAAC,CAAE,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IACnF;AAAA,iDAC0CL,CAAa,eAAeD,CAAY,UAAUE,CAAI;AAAA;AAAA,8BAEzEC,CAAK;AAAA,8BACLC,CAAK;AAAA,iCACFC,CAAQ;AAAA,kCACPC,CAAS;AAAA;AAAA,cAE7B,EAAE,KAAK,EAAE,CAAC,EACpBV,EAAmB,QAAO,CAC9B,CAEO,MAAMW,EAAe,IAAM,CAC9Bd,EAAQ,UAAY,EACxB,EAEae,EAAa,IAAM,CAC5Bd,EAAQ,UAAU,OAAO,iBAAiB,CAC9C,EAEae,EAAa,IAAM,CAC5Bf,EAAQ,UAAU,IAAI,iBAAiB,CAC3C,EAEagB,EAAqB,IAAM,CACpCf,EAAY,UAAU,OAAO,iBAAiB,CAClD,EAEagB,EAAqB,IAAM,CACpChB,EAAY,UAAU,IAAI,iBAAiB,CAC/C,ECpCMiB,EAAa,SAAS,cAAc,OAAO,EAC3CjB,EAAc,SAAS,cAAc,YAAY,EACjDkB,EAAS,cACf,IAAItB,EAAO,EACPuB,EACJC,EAAiBxB,CAAI,EAErBqB,EAAW,iBAAiB,SAAUI,CAAW,EACjDrB,EAAY,iBAAiB,QAASsB,CAAc,EAEpD,eAAeD,EAAYE,EAAG,CAC1BA,EAAE,eAAc,EAChBV,IACAG,IACAJ,IAEA,MAAMjB,EAAQsB,EAAW,SAAS,CAAC,EAAE,MAAM,cAAc,OACzD,GAAItB,EAAM,QAAU,EAAG,CACnB6B,EAAS,KAAKC,CAAY,EAC1BX,IACAG,EAAW,MAAK,EAChB,MAER,CAAI,aAAa,QAAQC,EAAQvB,CAAK,EAElC,GAAI,CACA,KAAM,CAAE,KAAA+B,CAAM,EAAG,MAAMhC,EAAiBC,CAAK,EAI7C,GAHAQ,EAAcuB,EAAK,IAAI,EACvBP,EAAWO,EAAK,UAAYA,EAAK,KAAK,OAElC,CAAEA,EAAK,KAAK,OAAS,CACrBF,EAAS,KAAKC,CAAY,EAC1B,aAAa,WAAWP,CAAM,EAC9BF,IACA,MACH,CACGpB,EAAOuB,GACPJ,IAEAnB,IAASuB,GACTK,EAAS,KAAKG,CAAe,CAEpC,OAAQC,EAAO,CACZH,EAAa,QAAUG,EAAM,QAC7BJ,EAAS,KAAKC,CAAY,CAClC,QAAa,CACLX,IACAG,EAAW,MAAK,CACxB,CACA,CAEA,eAAeK,EAAeC,EAAG,CAC7BV,IACAjB,IACAI,EAAY,SAAW,GACvB,IAAI6B,EAAa,aAAa,QAAQX,CAAM,EAE5C,GAAI,CACA,KAAM,CAAE,KAAAQ,CAAI,EAAK,MAAMhC,EAAiBmC,EAAYjC,CAAI,EACxDO,EAAcuB,EAAK,IAAI,EACnB9B,GAAQuB,IACRH,IACA,aAAa,WAAWE,CAAM,EAC9BtB,EAAO,EACP4B,EAAS,KAAKG,CAAe,GAIjC,MAAMG,EADO,SAAS,cAAc,aAAa,EACvB,sBAAqB,EAAG,OAClD,OAAO,SAAS,CACZ,KAAM,EACN,IAAKA,EAAe,EACpB,SAAU,QACtB,CAAS,CACJ,OAAQF,EAAO,CACZH,EAAa,QAAUG,EAAM,QAC7BJ,EAAS,KAAKC,CAAY,CAClC,QAAK,CACGX,IACAd,EAAY,SAAW,EAC/B,CACA,CAEA,eAAeoB,EAAiBxB,EAAM,CAElC,GADAiB,IACI,aAAa,OAAS,EACtB,GAAI,CACA,KAAM,CAAE,KAAAa,CAAM,EAAG,MAAMhC,EAAiB,aAAa,QAAQwB,CAAM,EAAGtB,CAAI,EAC1EO,EAAcuB,EAAK,IAAI,EACnB9B,EAAQ8B,EAAK,UAAYA,EAAK,KAAK,QACnCX,IAEAnB,IAAU8B,EAAK,UAAYA,EAAK,KAAK,QACrCF,EAAS,KAAKG,CAAe,CAEpC,OAAQC,EAAO,CACZH,EAAa,QAAUG,EAAM,QAC7BJ,EAAS,KAAKC,CAAY,CAC7B,CAELX,EAAU,CACd,CAEA,MAAMW,EAAe,CACjB,MAAO,QACP,WAAY,UACZ,QAAS,2EACT,UAAW,UACX,MAAO,UACP,aAAc,UACd,SAAU,WACV,YAAa,OACb,YAAa,MACjB,EAEME,EAAkB,CACpB,MAAO,GACP,WAAY,UACZ,QAAS,6DACT,UAAW,UACX,MAAO,UACP,aAAc,UACd,SAAU,WACV,YAAa,OACb,YAAa,MACjB"}